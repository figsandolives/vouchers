<!doctype html>
<html lang="ar" dir="rtl">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù‚Ø³Ø§Ø¦Ù… Ø´Ø±Ø§Ø¡ - Ù…Ø®Ø¨Ø² Ø§Ù„ØªÙŠÙ† ÙˆØ§Ù„Ø²ÙŠØªÙˆÙ†</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: white;
      min-height: 100%;
      color: #333;
      line-height: 1.6;
    }

    * {
      box-sizing: border-box;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      min-height: 100%;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
      padding: 30px 0;
      border-bottom: 3px solid #2c5aa0;
    }

    .header h1 {
      font-size: 2.5rem;
      margin: 0;
      color: #2c5aa0;
      font-weight: 700;
    }

    .header p {
      color: #666;
      margin: 10px 0 0 0;
      font-size: 1.1rem;
    }

    .card {
      background: white;
      border-radius: 15px;
      box-shadow: 0 8px 25px rgba(44, 90, 160, 0.1);
      padding: 30px;
      margin-bottom: 20px;
      border: 1px solid #e9ecef;
    }

    .search-section {
      text-align: center;
      padding: 40px 20px;
    }

    .input-group {
      margin-bottom: 25px;
    }

    .input-label {
      display: block;
      margin-bottom: 10px;
      font-weight: 600;
      color: #2c5aa0;
      font-size: 1.1rem;
    }

    .form-input {
      width: 100%;
      padding: 15px 20px;
      border: 2px solid #e9ecef;
      border-radius: 10px;
      font-size: 18px;
      transition: all 0.3s ease;
      background: #f8f9fa;
      text-align: center;
      font-weight: 600;
    }

    .form-input:focus {
      outline: none;
      border-color: #2c5aa0;
      box-shadow: 0 0 0 3px rgba(44, 90, 160, 0.1);
      background: white;
    }

    .btn {
      padding: 15px 30px;
      border: none;
      border-radius: 10px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 16px;
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }

    .btn-primary {
      background: linear-gradient(135deg, #2c5aa0, #1e3d72);
      color: white;
      box-shadow: 0 4px 15px rgba(44, 90, 160, 0.3);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(44, 90, 160, 0.4);
    }

    .btn-success {
      background: linear-gradient(135deg, #28a745, #20c997);
      color: white;
      box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
    }

    .btn-success:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(40, 167, 69, 0.4);
    }

    .btn-danger {
      background: linear-gradient(135deg, #dc3545, #c82333);
      color: white;
      box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
    }

    .btn-danger:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(220, 53, 69, 0.4);
    }

    .btn-secondary {
      background: #f8f9fa;
      color: #495057;
      border: 2px solid #dee2e6;
    }

    .btn-secondary:hover {
      background: #e9ecef;
      transform: translateY(-1px);
    }

    .voucher-info {
      background: linear-gradient(135deg, #2c5aa0, #1e3d72);
      color: white;
      padding: 30px;
      border-radius: 15px;
      margin-bottom: 30px;
      text-align: center;
    }

    .voucher-code {
      font-size: 3rem;
      font-weight: bold;
      margin-bottom: 15px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    .voucher-details {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .detail-item {
      background: rgba(255, 255, 255, 0.1);
      padding: 15px;
      border-radius: 10px;
      text-align: center;
    }

    .detail-label {
      font-size: 0.9rem;
      opacity: 0.8;
      margin-bottom: 5px;
    }

    .detail-value {
      font-size: 1.2rem;
      font-weight: bold;
    }

    .table-container {
      overflow-x: auto;
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }

    .table {
      width: 100%;
      border-collapse: collapse;
      background: white;
    }

    .table th {
      background: #2c5aa0;
      color: white;
      padding: 15px;
      text-align: right;
      font-weight: 600;
    }

    .table td {
      padding: 12px 15px;
      border-bottom: 1px solid #e9ecef;
    }

    .table tr:hover {
      background: #f8f9fa;
    }

    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(5px);
    }

    .modal-content {
      background-color: white;
      margin: 5% auto;
      padding: 30px;
      border-radius: 15px;
      width: 90%;
      max-width: 500px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
      animation: modalSlideIn 0.3s ease;
    }

    @keyframes modalSlideIn {
      from { opacity: 0; transform: translateY(-50px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .close {
      color: #aaa;
      float: left;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }

    .close:hover {
      color: #000;
    }

    .hidden {
      display: none !important;
    }

    .fade-in {
      animation: fadeIn 0.5s ease-in;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }



    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .alert {
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 20px;
      border-left: 4px solid;
    }

    .alert-error {
      background: #f8d7da;
      color: #721c24;
      border-left-color: #dc3545;
    }

    .alert-success {
      background: #d4edda;
      color: #155724;
      border-left-color: #28a745;
    }

    .grid-2 {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
    }

    .action-buttons {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-top: 20px;
    }

    .connection-status {
      position: fixed;
      top: 10px;
      right: 10px;
      padding: 5px 10px;
      border-radius: 5px;
      font-size: 12px;
      font-weight: bold;
      z-index: 9999;
    }

    .connected {
      background: #d4edda;
      color: #155724;
    }

    .disconnected {
      background: #f8d7da;
      color: #721c24;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .container {
        padding: 15px;
      }

      .header h1 {
        font-size: 2rem;
      }

      .voucher-code {
        font-size: 2.5rem;
      }

      .modal-content {
        margin: 10% auto;
        padding: 20px;
      }

      .detail-item {
        padding: 10px;
      }

      .table th, .table td {
        padding: 8px 10px;
        font-size: 14px;
      }
    }

    @media print {
      body {
        background: white !important;
      }
      
      .btn, .modal, .connection-status {
        display: none !important;
      }
      
      .card {
        box-shadow: none;
        border: 1px solid #ddd;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="connection-status" id="connectionStatus">
   ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„...
  </div>
  <div class="container"><!-- Main Search Page -->
   <div id="mainPage">
    <div class="header" id="headerArea">
     <h1>Ù‚Ø³Ø§Ø¦Ù… Ø´Ø±Ø§Ø¡</h1>
     <p>Ù…Ø®Ø¨Ø² Ø§Ù„ØªÙŠÙ† ÙˆØ§Ù„Ø²ÙŠØªÙˆÙ† - Ù…Ø·Ø¹Ù… Ø§Ù„ØªÙŠÙ† Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ</p>
    </div>
    <div class="card search-section">
     <div class="input-group"><label class="input-label">Ø§ÙƒØªØ¨ Ø±Ù…Ø² Ø§Ù„Ù‚Ø³ÙŠÙ…Ø© Ù‡Ù†Ø§</label> <input type="text" id="voucherCode" class="form-input" placeholder="0000" maxlength="4">
     </div><button id="nextBtn" class="btn btn-primary hidden" style="font-size: 1.1rem; padding: 15px 40px;"> Ø§Ù„ØªØ§Ù„ÙŠ </button>
     <div style="margin-top: 30px; text-align: center;"><button id="adminBtnMain" class="btn btn-secondary" style="font-size: 0.9rem; padding: 8px 20px;"> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ø¸Ø§Ù… </button>
     </div>
    </div>
   </div><!-- Voucher Details Page -->
   <div id="voucherPage" class="hidden">
    <div class="card">
     <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;"><button id="backBtn" class="btn btn-secondary">â† Ø§Ù„Ø¹ÙˆØ¯Ø©</button> <button id="printBtn" class="btn btn-primary">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
     </div>
     <div id="voucherInfo"></div>
     <div class="table-container">
      <table class="table">
       <thead>
        <tr>
         <th>Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©</th>
         <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
         <th>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù</th>
         <th>Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª</th>
         <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
        </tr>
       </thead>
       <tbody id="ordersTable">
       </tbody>
      </table>
     </div>
     <div class="action-buttons"><button id="addOrderBtn" class="btn btn-success">Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</button>
     </div>
    </div>
   </div><!-- Admin Page -->
   <div id="adminPage" class="hidden">
    <div class="card">
     <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
      <h2 style="margin: 0; color: #2c5aa0;">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚Ø³Ø§Ø¦Ù…</h2>
      <div><button id="printAllBtn" class="btn btn-primary" style="margin-left: 10px;">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙƒÙ„</button> <button id="addVoucherBtn" class="btn btn-success">Ø¥Ø¶Ø§ÙØ© Ù‚Ø³ÙŠÙ…Ø© Ø¬Ø¯ÙŠØ¯Ø©</button> <button id="exitAdminBtn" class="btn btn-secondary">Ø®Ø±ÙˆØ¬</button>
      </div>
     </div>
     <div class="table-container">
      <table class="table">
       <thead>
        <tr>
         <th>Ø§Ù„Ø±Ù…Ø²</th>
         <th>Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†</th>
         <th>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</th>
         <th>Ù…Ø¨Ù„Øº Ø§Ù„Ù‚Ø³ÙŠÙ…Ø©</th>
         <th>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
         <th>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</th>
         <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡</th>
         <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
        </tr>
       </thead>
       <tbody id="adminVouchersTable">
       </tbody>
      </table>
     </div>
    </div>
   </div>
  </div><!-- Add Order Modal -->
  <div id="orderModal" class="modal">
   <div class="modal-content"><span class="close" id="closeOrderModal">Ã—</span>
    <h3 style="text-align: center; color: #2c5aa0; margin-bottom: 25px;">Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</h3>
    <form id="orderForm">
     <div class="grid-2">
      <div class="input-group"><label class="input-label">Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†</label> <input type="text" id="orderCustomerName" class="form-input" readonly>
      </div>
      <div class="input-group"><label class="input-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label> <input type="text" id="orderCustomerPhone" class="form-input" readonly>
      </div>
     </div>
     <div class="input-group"><label class="input-label">Ø±Ù…Ø² Ø§Ù„Ù‚Ø³ÙŠÙ…Ø©</label> <input type="text" id="orderVoucherCode" class="form-input" readonly>
     </div>
     <div class="input-group"><label class="input-label">Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©</label> <input type="text" id="invoiceNumber" class="form-input" required>
     </div>
     <div class="input-group"><label class="input-label">Ù…Ø¨Ù„Øº Ø§Ù„ÙØ§ØªÙˆØ±Ø©</label> <input type="text" id="invoiceAmount" class="form-input" required>
     </div>
     <div class="input-group"><label class="input-label">Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù</label> <input type="text" id="employeeName" class="form-input" required>
     </div><button type="submit" class="btn btn-success" style="width: 100%; margin-top: 20px;"> Ø®ØµÙ… Ù…Ù† Ø§Ù„Ù‚Ø³ÙŠÙ…Ø© </button>
    </form>
   </div>
  </div><!-- Add Voucher Modal -->
  <div id="voucherModal" class="modal">
   <div class="modal-content"><span class="close" id="closeVoucherModal">Ã—</span>
    <h3 style="text-align: center; color: #2c5aa0; margin-bottom: 25px;">Ø¥Ø¶Ø§ÙØ© Ù‚Ø³ÙŠÙ…Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>
    <form id="voucherForm">
     <div class="input-group"><label class="input-label">Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†</label> <input type="text" id="newCustomerName" class="form-input" required>
     </div>
     <div class="input-group"><label class="input-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label> <input type="text" id="newCustomerPhone" class="form-input" required>
     </div>
     <div class="input-group"><label class="input-label">Ù…Ø¨Ù„Øº Ø§Ù„Ù‚Ø³ÙŠÙ…Ø©</label> <input type="text" id="newVoucherAmount" class="form-input" required>
     </div><button type="submit" class="btn btn-success" style="width: 100%; margin-top: 20px;"> Ø¥Ø¶Ø§ÙØ© </button>
    </form>
   </div>
  </div><!-- Admin Password Modal -->
  <div id="passwordModal" class="modal">
   <div class="modal-content"><span class="close" id="closePasswordModal">Ã—</span>
    <h3 style="text-align: center; color: #2c5aa0; margin-bottom: 25px;">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</h3>
    <div class="input-group"><input type="password" id="adminPassword" class="form-input" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
    </div><button id="loginBtn" class="btn btn-primary" style="width: 100%;"> Ø¯Ø®ÙˆÙ„ </button>
   </div>
  </div>
  <script>
    // Firebase Configuration
    const firebaseConfig = {
      apiKey: "AIzaSyBIP8ezD990c7kZ3z-gsma2KJpp7Zqu7eA",
      authDomain: "ishtrakta.firebaseapp.com",
      databaseURL: "https://ishtrakta-default-rtdb.firebaseio.com",
      projectId: "ishtrakta",
      storageBucket: "ishtrakta.firebasestorage.app",
      messagingSenderId: "854766859254",
      appId: "1:854766859254:web:0375c2c8c9c518b2f74dd7",
      measurementId: "G-QT71DGNRXT"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    // Global Variables
    let currentVoucher = null;
    let isConnected = false;

    // Connection Status Monitor
    database.ref('.info/connected').on('value', function(snapshot) {
      isConnected = snapshot.val() === true;
      updateConnectionStatus();
    });

    function updateConnectionStatus() {
      const statusElement = document.getElementById('connectionStatus');
      if (isConnected) {
        statusElement.textContent = 'ğŸŸ¢ Ù…ØªØµÙ„';
        statusElement.className = 'connection-status connected';
      } else {
        statusElement.textContent = 'ğŸ”´ ØºÙŠØ± Ù…ØªØµÙ„';
        statusElement.className = 'connection-status disconnected';
      }
    }

    // Utility Functions
    function convertArabicToEnglish(str) {
      const arabicNumbers = ['Ù ', 'Ù¡', 'Ù¢', 'Ù£', 'Ù¤', 'Ù¥', 'Ù¦', 'Ù§', 'Ù¨', 'Ù©'];
      const englishNumbers = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'];
      
      let result = str;
      arabicNumbers.forEach((arabic, index) => {
        result = result.replace(new RegExp(arabic, 'g'), englishNumbers[index]);
      });
      
      result = result.replace(/ØŒ/g, '.');
      return result;
    }

    function generateVoucherCode() {
      return Math.floor(1000 + Math.random() * 9000).toString();
    }

    function formatDate(timestamp) {
      const date = new Date(timestamp);
      return date.toLocaleDateString('en-GB', {
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit'
      }).replace(/\//g, '-');
    }

    function showAlert(message, type = 'error') {
      const alert = document.createElement('div');
      alert.className = `alert alert-${type} fade-in`;
      alert.textContent = message;
      alert.style.position = 'fixed';
      alert.style.top = '60px';
      alert.style.right = '20px';
      alert.style.zIndex = '9999';
      alert.style.maxWidth = '400px';
      
      document.body.appendChild(alert);
      
      setTimeout(() => {
        alert.remove();
      }, 5000);
    }

function openWhatsApp(phone, message) {
    const cleanPhone = phone.replace(/[^0-9]/g, '');
    
    // ÙŠØ¶ÙŠÙ Ø±Ù…Ø² Ø§Ù„Ø¯ÙˆÙ„Ø© (965) Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ù‹Ø§
    const fullPhone = cleanPhone.startsWith('965') ? cleanPhone : '965' + cleanPhone;
    
    const encodedMessage = encodeURIComponent(message);
    const whatsappUrl = `https://wa.me/${fullPhone}?text=${encodedMessage}`;
    
    // Ù†ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø· ÙÙŠ Ù†ÙØ³ Ø§Ù„Ù†Ø§ÙØ°Ø©/Ø¹Ù„Ø§Ù…Ø© Ø§Ù„ØªØ¨ÙˆÙŠØ¨ (Ø¨Ø¯ÙˆÙ† '_blank')
    // Ù‡Ø°Ø§ ÙŠØ³Ù…Ø­ Ù„Ù„Ù…ØªØµÙØ­ Ø¨ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙØªØ­ Ø¥Ù„Ù‰ ØªØ·Ø¨ÙŠÙ‚ ÙˆØ§ØªØ³Ø§Ø¨ Ù…Ø¨Ø§Ø´Ø±Ø©.
    window.open(whatsappUrl);
    
    // Ù…Ù„Ø§Ø­Ø¸Ø© Ø¥Ø¶Ø§ÙÙŠØ©: Ø¥Ø°Ø§ Ø§Ø³ØªÙ…Ø±Øª Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø¹Ù„Ù‰ Ø¨Ø¹Ø¶ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© (Ù…Ø«Ù„ iOS)ØŒ 
    // ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù… 'window.location.href = whatsappUrl;' Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† 'window.open(whatsappUrl);'
}

    // Firebase Operations - Primary Storage
    async function saveVoucher(voucherData) {
      if (!isConnected) {
        showAlert('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
        return false;
      }

      try {
        await database.ref('vouchers/' + voucherData.code).set(voucherData);
        return true;
      } catch (error) {
        console.error('Error saving voucher:', error);
        showAlert('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
        return false;
      }
    }

    async function getVoucher(code) {
      if (!isConnected) {
        showAlert('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
        return null;
      }

      try {
        const snapshot = await database.ref('vouchers/' + code).once('value');
        return snapshot.val();
      } catch (error) {
        console.error('Error getting voucher:', error);
        showAlert('Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
        return null;
      }
    }

    async function getAllVouchers() {
      if (!isConnected) {
        showAlert('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
        return [];
      }

      try {
        const snapshot = await database.ref('vouchers').once('value');
        const vouchers = [];
        snapshot.forEach(child => {
          vouchers.push(child.val());
        });
        return vouchers.sort((a, b) => (b.createdAt || 0) - (a.createdAt || 0));
      } catch (error) {
        console.error('Error getting all vouchers:', error);
        showAlert('Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
        return [];
      }
    }

    async function deleteVoucher(code) {
      if (!isConnected) {
        showAlert('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
        return false;
      }

      try {
        await database.ref('vouchers/' + code).remove();
        return true;
      } catch (error) {
        console.error('Error deleting voucher:', error);
        showAlert('Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
        return false;
      }
    }

    // Page Navigation
    function showPage(pageId) {
      document.querySelectorAll('#mainPage, #voucherPage, #adminPage').forEach(page => {
        page.classList.add('hidden');
      });
      document.getElementById(pageId).classList.remove('hidden');
    }

    function showModal(modalId) {
      document.getElementById(modalId).style.display = 'block';
    }

    function hideModal(modalId) {
      document.getElementById(modalId).style.display = 'none';
    }

    // Voucher Display
    function displayVoucherInfo(voucher) {
      const voucherInfo = document.getElementById('voucherInfo');
      voucherInfo.innerHTML = `
        <div class="voucher-info fade-in">
          <div class="voucher-code">${voucher.code}</div>
          <div class="voucher-details">
            <div class="detail-item">
              <div class="detail-label">Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†</div>
              <div class="detail-value">${voucher.customerName}</div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</div>
              <div class="detail-value">${voucher.customerPhone}</div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Ù‚ÙŠÙ…Ø© Ø§Ù„Ù‚Ø³ÙŠÙ…Ø©</div>
              <div class="detail-value">${voucher.totalAmount.toFixed(2)} Ø¯.Ùƒ</div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</div>
              <div class="detail-value" style="color: #dc3545;">${voucher.usedAmount.toFixed(2)} Ø¯.Ùƒ</div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</div>
              <div class="detail-value" style="color: ${voucher.remainingAmount > 0 ? '#28a745' : '#dc3545'};">${voucher.remainingAmount.toFixed(2)} Ø¯.Ùƒ</div>
            </div>
          </div>
        </div>
      `;
    }

    function displayOrders(orders) {
      const ordersTable = document.getElementById('ordersTable');
      
      if (!orders || orders.length === 0) {
        ordersTable.innerHTML = `
          <tr>
            <td colspan="5" style="text-align: center; padding: 40px; color: #666;">
              Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¨Ø¹Ø¯
            </td>
          </tr>
        `;
        return;
      }

      ordersTable.innerHTML = orders.map((order, index) => `
        <tr>
          <td>${order.invoiceNumber}</td>
          <td>${order.amount.toFixed(2)} Ø¯.Ùƒ</td>
          <td>${order.employeeName}</td>
          <td>${formatDate(order.createdAt)}</td>
          <td>
            <button class="btn btn-danger" style="padding: 5px 10px; font-size: 12px;" onclick="deleteOrder(${index})">
              Ø­Ø°Ù
            </button>
          </td>
        </tr>
      `).join('');
    }

    function displayAdminVouchers(vouchers) {
      const adminTable = document.getElementById('adminVouchersTable');
      
      if (!vouchers || vouchers.length === 0) {
        adminTable.innerHTML = `
          <tr>
            <td colspan="8" style="text-align: center; padding: 40px; color: #666;">
              Ù„Ø§ ØªÙˆØ¬Ø¯ Ù‚Ø³Ø§Ø¦Ù… Ø¨Ø¹Ø¯
            </td>
          </tr>
        `;
        return;
      }

      adminTable.innerHTML = vouchers.map(voucher => `
        <tr>
          <td style="font-weight: bold; color: #2c5aa0;">${voucher.code}</td>
          <td>${voucher.customerName}</td>
          <td>${voucher.customerPhone}</td>
          <td>${voucher.totalAmount.toFixed(2)} Ø¯.Ùƒ</td>
          <td style="color: #dc3545;">${voucher.usedAmount.toFixed(2)} Ø¯.Ùƒ</td>
          <td style="color: ${voucher.remainingAmount > 0 ? '#28a745' : '#dc3545'};">${voucher.remainingAmount.toFixed(2)} Ø¯.Ùƒ</td>
          <td>${formatDate(voucher.createdAt)}</td>
          <td>
            <button class="btn btn-danger" style="padding: 5px 10px; font-size: 12px;" onclick="deleteVoucherAdmin('${voucher.code}')">
              Ø­Ø°Ù
            </button>
          </td>
        </tr>
      `).join('');
    }

    // Order Management
    async function deleteOrder(orderIndex) {
      if (!currentVoucher) return;
      
      if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø·Ù„Ø¨ØŸ')) return;
      
      const order = currentVoucher.orders[orderIndex];
      currentVoucher.orders.splice(orderIndex, 1);
      currentVoucher.usedAmount -= order.amount;
      currentVoucher.remainingAmount += order.amount;
      
      const saved = await saveVoucher(currentVoucher);
      if (saved) {
        displayVoucherInfo(currentVoucher);
        displayOrders(currentVoucher.orders);
        showAlert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­', 'success');
      }
    }

    async function deleteVoucherAdmin(code) {
      if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø³ÙŠÙ…Ø©ØŸ')) return;
      
      const deleted = await deleteVoucher(code);
      if (deleted) {
        loadAdminVouchers();
        showAlert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù‚Ø³ÙŠÙ…Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
      }
    }

    async function loadAdminVouchers() {
      const vouchers = await getAllVouchers();
      displayAdminVouchers(vouchers);
    }

    // Event Handlers
    document.addEventListener('DOMContentLoaded', () => {
      // Voucher code input
      const voucherCodeInput = document.getElementById('voucherCode');
      const nextBtn = document.getElementById('nextBtn');
      
      voucherCodeInput.addEventListener('input', (e) => {
        e.target.value = convertArabicToEnglish(e.target.value);
        
        if (e.target.value.length === 4) {
          nextBtn.classList.remove('hidden');
        } else {
          nextBtn.classList.add('hidden');
        }
      });

      // Next button
      nextBtn.addEventListener('click', async () => {
        const code = voucherCodeInput.value.trim();
        
        if (code.length !== 4) {
          showAlert('Ø±Ù…Ø² Ø§Ù„Ù‚Ø³ÙŠÙ…Ø© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 4 Ø£Ø±Ù‚Ø§Ù…');
          return;
        }
        
        nextBtn.disabled = true;
        nextBtn.innerHTML = '<span class="loading"></span> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø«...';
        
        const voucher = await getVoucher(code);
        
        if (voucher) {
          currentVoucher = voucher;
          displayVoucherInfo(voucher);
          displayOrders(voucher.orders || []);
          showPage('voucherPage');
        } else if (isConnected) {
          showAlert('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù‚Ø³ÙŠÙ…Ø© Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø±Ù…Ø²');
        }
        
        nextBtn.disabled = false;
        nextBtn.textContent = 'Ø§Ù„ØªØ§Ù„ÙŠ';
      });

      // Back button
      document.getElementById('backBtn').addEventListener('click', () => {
        showPage('mainPage');
        voucherCodeInput.value = '';
        nextBtn.classList.add('hidden');
      });

      // Print button
      document.getElementById('printBtn').addEventListener('click', () => {
        window.print();
      });

      // Add order button
      document.getElementById('addOrderBtn').addEventListener('click', () => {
        if (!currentVoucher) return;
        
        if (currentVoucher.remainingAmount <= 0) {
          showAlert('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø¨Ù„Øº Ù…ØªØ¨Ù‚ÙŠ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø³ÙŠÙ…Ø©');
          return;
        }
        
        document.getElementById('orderCustomerName').value = currentVoucher.customerName;
        document.getElementById('orderCustomerPhone').value = currentVoucher.customerPhone;
        document.getElementById('orderVoucherCode').value = currentVoucher.code;
        
        showModal('orderModal');
      });

      // Order form
      document.getElementById('orderForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const invoiceNumber = document.getElementById('invoiceNumber').value.trim();
        const invoiceAmount = parseFloat(convertArabicToEnglish(document.getElementById('invoiceAmount').value.trim()));
        const employeeName = document.getElementById('employeeName').value.trim();
        
        if (!invoiceNumber || !invoiceAmount || !employeeName) {
          showAlert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„');
          return;
        }
        
        if (invoiceAmount <= 0) {
          showAlert('Ù…Ø¨Ù„Øº Ø§Ù„ÙØ§ØªÙˆØ±Ø© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±');
          return;
        }
        
        if (invoiceAmount > currentVoucher.remainingAmount) {
          showAlert(`Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ (${currentVoucher.remainingAmount.toFixed(2)} Ø¯.Ùƒ)`);
          return;
        }
        
        const submitBtn = e.target.querySelector('button[type="submit"]');
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<span class="loading"></span> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...';
        
        const order = {
          invoiceNumber,
          amount: invoiceAmount,
          employeeName,
          createdAt: Date.now()
        };
        
        if (!currentVoucher.orders) currentVoucher.orders = [];
        currentVoucher.orders.push(order);
        currentVoucher.usedAmount += invoiceAmount;
        currentVoucher.remainingAmount -= invoiceAmount;
        
        const saved = await saveVoucher(currentVoucher);
        
        if (saved) {
          displayVoucherInfo(currentVoucher);
          displayOrders(currentVoucher.orders);
          hideModal('orderModal');
          e.target.reset();
          
          // WhatsApp message
          const message = `Ù…Ø±Ø­Ø¨Ø§ ${currentVoucher.customerName}
Ø´ÙƒØ±Ø§Ù‹ Ù„Ø´Ø±Ø§Ø¦Ùƒ Ù…Ù† Ù…Ø®Ø¨Ø² Ø§Ù„ØªÙŠÙ† ÙˆØ§Ù„Ø²ÙŠØªÙˆÙ†ØŒ Ùˆ Ù…Ø·Ø¹Ù… Ø§Ù„ØªÙŠÙ† Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ
ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ù…Ø² Ø§Ù„Ù‚Ø³ÙŠÙ…Ø© Ø§Ù„ØªØ§Ù„ÙŠ: ${currentVoucher.code}
Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø®ØµÙˆÙ… Ù‡Ùˆ: ${invoiceAmount.toFixed(2)} Ø¯.Ùƒ
Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù…Ù† Ø§Ù„Ù‚Ø³ÙŠÙ…Ø©: ${currentVoucher.remainingAmount.toFixed(2)} Ø¯.Ùƒ

Ù„Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø¹Ù† Ù‚Ø³ÙŠÙ…ØªÙƒ ÙÙŠ Ø§Ù„Ù…Ø±Ø§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø© Ø§Ø¯Ø®Ù„ Ù…ÙˆÙ‚Ø¹Ù†Ø§ Ø§Ù„Ø§Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:
https://figsnolives.mypaydo.shop/shop

Ø«Ù… Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© (Ø§Ù„Ø«Ù„Ø§Ø« Ø®Ø·ÙˆØ·) Ø§Ø®ØªØ±ØŒ Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø¹Ù† Ù‚Ø³ÙŠÙ…Ø©..
Ø´ÙƒØ±Ø§ Ù„Ùƒ..`;
          
          openWhatsApp(currentVoucher.customerPhone, message);
          showAlert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }
        
        submitBtn.disabled = false;
        submitBtn.textContent = 'Ø®ØµÙ… Ù…Ù† Ø§Ù„Ù‚Ø³ÙŠÙ…Ø©';
      });

      // Invoice amount input conversion
      document.getElementById('invoiceAmount').addEventListener('input', (e) => {
        e.target.value = convertArabicToEnglish(e.target.value);
      });

      document.getElementById('newVoucherAmount').addEventListener('input', (e) => {
        e.target.value = convertArabicToEnglish(e.target.value);
      });

      // Phone number input conversion
      document.getElementById('newCustomerPhone').addEventListener('input', (e) => {
        e.target.value = convertArabicToEnglish(e.target.value);
      });

      // Admin functionality
      document.getElementById('adminBtnMain').addEventListener('click', () => {
        showModal('passwordModal');
      });

      document.getElementById('loginBtn').addEventListener('click', () => {
        const password = document.getElementById('adminPassword').value;
        if (password === '5564') {
          hideModal('passwordModal');
          showPage('adminPage');
          loadAdminVouchers();
          document.getElementById('adminPassword').value = '';
        } else {
          showAlert('ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©');
        }
      });

      document.getElementById('exitAdminBtn').addEventListener('click', () => {
        showPage('mainPage');
      });

      document.getElementById('addVoucherBtn').addEventListener('click', () => {
        showModal('voucherModal');
      });

      document.getElementById('printAllBtn').addEventListener('click', () => {
        window.print();
      });

      // Voucher form
      document.getElementById('voucherForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const customerName = document.getElementById('newCustomerName').value.trim();
        const customerPhone = document.getElementById('newCustomerPhone').value.trim();
        const totalAmount = parseFloat(convertArabicToEnglish(document.getElementById('newVoucherAmount').value.trim()));
        
        if (!customerName || !customerPhone || !totalAmount) {
          showAlert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„');
          return;
        }
        
        if (totalAmount <= 0) {
          showAlert('Ù…Ø¨Ù„Øº Ø§Ù„Ù‚Ø³ÙŠÙ…Ø© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±');
          return;
        }
        
        const submitBtn = e.target.querySelector('button[type="submit"]');
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<span class="loading"></span> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø¶Ø§ÙØ©...';
        
        const code = generateVoucherCode();
        const voucher = {
          code,
          customerName,
          customerPhone,
          totalAmount,
          usedAmount: 0,
          remainingAmount: totalAmount,
          orders: [],
          createdAt: Date.now()
        };
        
        const saved = await saveVoucher(voucher);
        
        if (saved) {
          loadAdminVouchers();
          hideModal('voucherModal');
          e.target.reset();
          
          // WhatsApp message
          const message = `ØªÙ… Ø§Ù†Ø´Ø§Ø¡ Ø£Ù…Ø± Ù‚Ø³ÙŠÙ…Ø© Ø´Ø±Ø§Ø¦ÙŠØ© Ù…Ù† Ù…Ø®Ø¨Ø² Ø§Ù„ØªÙŠÙ† ÙˆØ§Ù„Ø²ÙŠØªÙˆÙ† Ùˆ Ù…Ø·Ø¹Ù… Ø§Ù„ØªÙŠÙ† Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØŒ
Ø§Ù„Ø§Ø³Ù…: ${customerName}
Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: ${customerPhone}
Ø±Ù…Ø² Ø§Ù„Ù‚Ø³ÙŠÙ…Ø©: ${code}
Ù…Ø¨Ù„Øº Ø§Ù„Ù‚Ø³ÙŠÙ…Ø©: ${totalAmount.toFixed(2)} Ø¯.Ùƒ

Ù„Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø¹Ù† Ù‚Ø³ÙŠÙ…ØªÙƒ ÙÙŠ Ø§Ù„Ù…Ø±Ø§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø© Ø§Ø¯Ø®Ù„ Ù…ÙˆÙ‚Ø¹Ù†Ø§ Ø§Ù„Ø§Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:
https://figsnolives.mypaydo.shop/shop

Ø«Ù… Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© (Ø§Ù„Ø«Ù„Ø§Ø« Ø®Ø·ÙˆØ·) Ø§Ø®ØªØ±ØŒ Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø¹Ù† Ù‚Ø³ÙŠÙ…Ø©..
Ø´ÙƒØ±Ø§ Ù„Ùƒ..`;
          
          openWhatsApp(customerPhone, message);
          showAlert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ø³ÙŠÙ…Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }
        
        submitBtn.disabled = false;
        submitBtn.textContent = 'Ø¥Ø¶Ø§ÙØ©';
      });

      // Modal close buttons
      document.querySelectorAll('.close').forEach(closeBtn => {
        closeBtn.addEventListener('click', (e) => {
          e.target.closest('.modal').style.display = 'none';
        });
      });

      // Close modals when clicking outside
      window.addEventListener('click', (e) => {
        if (e.target.classList.contains('modal')) {
          e.target.style.display = 'none';
        }
      });
    });
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'999d277225f5db6f',t:'MTc2MjM1NDEyOC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
